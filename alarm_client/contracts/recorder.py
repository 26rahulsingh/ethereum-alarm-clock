import json
from web3.contract import Contract


RECORDER_ABI = json.loads('[{"constant":true,"inputs":[],"name":"lastCaller","outputs":[{"name":"","type":"address"}],"type":"function"},{"constant":false,"inputs":[{"name":"to","type":"address"},{"name":"callData","type":"bytes"}],"name":"__proxy","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":true,"inputs":[],"name":"lastCallGas","outputs":[{"name":"","type":"uint256"}],"type":"function"},{"constant":false,"inputs":[],"name":"kill","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"lastCallData","outputs":[{"name":"","type":"bytes"}],"type":"function"},{"constant":false,"inputs":[],"name":"__reset__","outputs":[],"type":"function"},{"constant":false,"inputs":[{"name":"to","type":"address"},{"name":"callData","type":"bytes"},{"name":"callGas","type":"uint256"}],"name":"__proxy","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":false,"inputs":[{"name":"to","type":"address"}],"name":"__proxy","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":true,"inputs":[],"name":"wasCalled","outputs":[{"name":"","type":"bool"}],"type":"function"},{"constant":true,"inputs":[],"name":"lastCallValue","outputs":[{"name":"","type":"uint256"}],"type":"function"},{"inputs":[],"type":"constructor"}]')  # noqa


RECORDER_BIN = '0x606060405260008054600160a060020a0319163317905561059c806100246000396000f3606060405236156100825760e060020a60003504632113522a81146101075780632667f407146101195780632b589b28146101dc57806341c0e1b5146101e557806372a853b1146102035780637cbcc254146102615780639af605cb146102d5578063ad8ed3351461039a578063c6803622146103c8578063f87af023146103db575b6103e45a6004556003805460008281526020601f600260001961010060018716150201909416939093048301047fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b908101923692908390106103e657803560ff19168380011785555b506104169291505b8082111561046357600081556001016100f3565b610467600254600160a060020a031681565b60408051602060248035600481810135601f81018590048502860185019096528585526104839581359591946044949293909201918190840183828082843750949650505050505050600082600160a060020a03163483604051808280519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156101bd5780820380516001836020036101000a031916815260200191505b5091505060006040518083038185876185025a03f19695505050505050565b61049760045481565b6103e460005433600160a060020a0390811691161461051757610002565b6040805160038054602060026001831615610100026000190190921691909104601f81018290048202840182019094528383526104a993908301828280156105505780601f1061052557610100808354040283529160200191610550565b6000600481905560408051602081810192839052908390526003805493819052915160ff191682556103e4926105589160026001831615610100026000190190921691909104601f01047fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b908101906100f3565b60408051602060248035600481810135601f810185900485028601850190965285855261048395813595919460449492939092019181908401838280828437509496505093359350505050600083600160a060020a031634839085604051808280519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561037d5780820380516001836020036101000a031916815260200191505b50915050600060405180830381858888f198975050505050505050565b610483600435604051600090600160a060020a0383169034908381818185876185025a03f195945050505050565b61048360005460a060020a900460ff1681565b61049760015481565b005b828001600101855582156100eb579182015b828111156100eb5782358260005055916020019190600101906103f8565b5050600280543373ffffffffffffffffffffffffffffffffffffffff19909116179055346001556000805474ff0000000000000000000000000000000000000000191660a060020a179055565b5090565b60408051600160a060020a039092168252519081900360200190f35b604080519115158252519081900360200190f35b60408051918252519081900360200190f35b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156105095780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b600054600160a060020a0316ff5b820191906000526020600020905b81548152906001019060200180831161053357829003601f168201915b505050505081565b50506002805473ffffffffffffffffffffffffffffffffffffffff1916905560006001819055805474ff00000000000000000000000000000000000000001916905556'


RECORDER_RUNTIME = '0x606060405236156100825760e060020a60003504632113522a81146101075780632667f407146101195780632b589b28146101dc57806341c0e1b5146101e557806372a853b1146102035780637cbcc254146102615780639af605cb146102d5578063ad8ed3351461039a578063c6803622146103c8578063f87af023146103db575b6103e45a6004556003805460008281526020601f600260001961010060018716150201909416939093048301047fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b908101923692908390106103e657803560ff19168380011785555b506104169291505b8082111561046357600081556001016100f3565b610467600254600160a060020a031681565b60408051602060248035600481810135601f81018590048502860185019096528585526104839581359591946044949293909201918190840183828082843750949650505050505050600082600160a060020a03163483604051808280519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156101bd5780820380516001836020036101000a031916815260200191505b5091505060006040518083038185876185025a03f19695505050505050565b61049760045481565b6103e460005433600160a060020a0390811691161461051757610002565b6040805160038054602060026001831615610100026000190190921691909104601f81018290048202840182019094528383526104a993908301828280156105505780601f1061052557610100808354040283529160200191610550565b6000600481905560408051602081810192839052908390526003805493819052915160ff191682556103e4926105589160026001831615610100026000190190921691909104601f01047fc2575a0e9e593c00f959f8c92f12db2869c3395a3b0502d05e2516446f71f85b908101906100f3565b60408051602060248035600481810135601f810185900485028601850190965285855261048395813595919460449492939092019181908401838280828437509496505093359350505050600083600160a060020a031634839085604051808280519060200190808383829060006004602084601f0104600302600f01f150905090810190601f16801561037d5780820380516001836020036101000a031916815260200191505b50915050600060405180830381858888f198975050505050505050565b610483600435604051600090600160a060020a0383169034908381818185876185025a03f195945050505050565b61048360005460a060020a900460ff1681565b61049760015481565b005b828001600101855582156100eb579182015b828111156100eb5782358260005055916020019190600101906103f8565b5050600280543373ffffffffffffffffffffffffffffffffffffffff19909116179055346001556000805474ff0000000000000000000000000000000000000000191660a060020a179055565b5090565b60408051600160a060020a039092168252519081900360200190f35b604080519115158252519081900360200190f35b60408051918252519081900360200190f35b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600302600f01f150905090810190601f1680156105095780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b600054600160a060020a0316ff5b820191906000526020600020905b81548152906001019060200180831161053357829003601f168201915b505050505081565b50506002805473ffffffffffffffffffffffffffffffffffffffff1916905560006001819055805474ff00000000000000000000000000000000000000001916905556'


class RecorderFactory(Contract):
    pass


def get_recorder(web3, address):
    return web3.eth.contract(
        abi=RECORDER_ABI,
        code=RECORDER_BIN,
        code_runtime=RECORDER_RUNTIME,
        address=address,
        base_contract_factory_class=RecorderFactory,
    )
